# Documentation Templates

Standard markdown templates for different types of Python files in the Unify project.

## Template: ETL Class (Gold/Silver Layer)

For files implementing the Extract-Transform-Load pattern with dedicated methods.

```markdown
# {module_name}

**File Path**: `{relative_path}`
**Repository Link**: [View Source]({repo_url})
**Layer**: {Gold|Silver}
**Lines of Code**: {line_count}

## Overview

{module_docstring or auto-generated description}

## ETL Pattern

This module implements the medallion architecture ETL pattern for {layer} layer transformation.

**Input Layer**: {Bronze|Silver}
**Output Layer**: {Silver|Gold}
**Source Table**: `{source_database}.{source_table}`
**Target Table**: `{target_database}.{target_table}`

### Transformation Workflow

1. **Extract**: Reads data from {source_layer} layer
2. **Transform**: Applies business logic and data quality rules
3. **Load**: Writes processed data to {target_layer} layer

## Class: {ClassName}

**Purpose**: {description}
**Pattern**: ETL (Extract-Transform-Load)

### Initialization

```python
{ClassName}(bronze_table_name: str)
```

Automatically executes the full ETL pipeline upon instantiation:
- `self.extract_sdf = self.extract()`
- `self.transform_sdf = self.transform()`
- `self.load()`

### Methods

#### `extract() -> DataFrame`
**Decorator**: `@synapse_error_print_handler`

Reads data from {source_layer} table using Spark SQL.

**Returns**: Spark DataFrame with source data

#### `transform() -> DataFrame`
**Decorator**: `@synapse_error_print_handler`

Applies transformations:
- {transformation_1}
- {transformation_2}
- {transformation_3}

**Returns**: Transformed Spark DataFrame

#### `load() -> None`
**Decorator**: `@synapse_error_print_handler`

Writes transformed data to {target_layer} using `TableUtilities.save_as_table()`.

**Output**: Persisted table in {target_database}

## Dependencies

### External Libraries
- `pyspark.sql`: Spark DataFrame operations
- `pyspark.sql.functions`: Spark SQL functions

### Internal Modules
- [`SparkOptimiser`](../utilities/session_optimiser#sparkoptimiser) - Spark session management
- [`TableUtilities`](../utilities/session_optimiser#tableutilities) - DataFrame operations
- [`NotebookLogger`](../utilities/session_optimiser#notebooklogger) - Logging

## Related Files

- [{silver_table}](../silver/{database}/{silver_table}) - Silver layer input
- [{bronze_table}](../bronze/{bronze_table}) - Bronze layer source

## Usage Example

```python
from {module_path} import {ClassName}

# Execute full ETL pipeline
table = {ClassName}(bronze_table_name="bronze_{db}.b_{table}")

# Access intermediate results
print(f"Extracted rows: {table.extract_sdf.count()}")
print(f"Transformed rows: {table.transform_sdf.count()}")
```

## Data Quality

{If applicable, list data quality rules applied}

---
*Auto-generated documentation*
*Last updated: {timestamp}*
*Generated by: wiki-auto-documenter skill*
```

## Template: Utility Module

For shared helper functions and reusable components.

```markdown
# {module_name}

**File Path**: `{relative_path}`
**Repository Link**: [View Source]({repo_url})
**Layer**: Utility
**Lines of Code**: {line_count}

## Overview

{module_docstring or auto-generated description}

This utility module provides shared functionality used across the Unify data migration pipeline.

## Functions

{For each function:}
### `{function_name}({parameters}) -> {return_type}`

{function_docstring or description}

**Parameters**:
- `{param1}`: {type} - {description}
- `{param2}`: {type} - {description}

**Returns**: {return_type} - {description}

**Decorators**: {decorator_list}

**Example**:
```python
from {module_path} import {function_name}

result = {function_name}(arg1, arg2)
```

## Classes

{For each class:}
### `{ClassName}`

{class_docstring or description}

**Methods**:
- `{method1}({params})` - {description}
- `{method2}({params})` - {description}

## Dependencies

### External Libraries
{List external imports}

### Internal Modules
{List internal imports with links}

## Usage Examples

```python
{Usage examples}
```

---
*Auto-generated documentation*
*Last updated: {timestamp}*
*Generated by: wiki-auto-documenter skill*
```

## Template: Test Module

For test files validating pipeline operations and data quality.

```markdown
# {module_name}

**File Path**: `{relative_path}`
**Repository Link**: [View Source]({repo_url})
**Layer**: Testing
**Lines of Code**: {line_count}

## Overview

Test suite for {component_under_test}.

## Test Functions

{For each test function:}
### `test_{function_name}()`

**Purpose**: {description}

**Test Scenario**: {scenario}

**Assertions**:
- {assertion_1}
- {assertion_2}

**Decorators**: {decorator_list}

## Test Coverage

**Components Tested**:
- {component_1}
- {component_2}

**Test Types**:
- {Unit|Integration|Data Validation}

## Dependencies

### Testing Framework
- `pytest`: Test execution framework

### Modules Under Test
{List modules being tested with links}

## Running Tests

```bash
# Run this test file
python -m pytest {file_path}

# Run with verbose output
python -m pytest {file_path} -v

# Run specific test
python -m pytest {file_path}::test_{function_name}
```

---
*Auto-generated documentation*
*Last updated: {timestamp}*
*Generated by: wiki-auto-documenter skill*
```

## Template: Pipeline Operation

For orchestration and deployment scripts.

```markdown
# {module_name}

**File Path**: `{relative_path}`
**Repository Link**: [View Source]({repo_url})
**Layer**: Pipeline Operations
**Lines of Code**: {line_count}

## Overview

{module_docstring or description}

Pipeline operation for {operation_description}.

## Operation Type

{Deployment|Orchestration|Configuration|Validation}

## Functions

{For each function:}
### `{function_name}({parameters}) -> {return_type}`

{function_docstring or description}

**Purpose**: {purpose}

**Process**:
1. {step_1}
2. {step_2}
3. {step_3}

**Parameters**:
- {param_list}

**Returns**: {return_description}

## Configuration

{If applicable, configuration requirements}

## Dependencies

### External Libraries
{List external imports}

### Internal Modules
{List internal imports with links}

## Usage

```bash
# Command line execution
make {command_name}

# Or direct Python execution
python {file_path}
```

## Error Handling

{Description of error handling approach}

---
*Auto-generated documentation*
*Last updated: {timestamp}*
*Generated by: wiki-auto-documenter skill*
```

## Template: Directory Index Page

For directory-level overview pages.

```markdown
# {Directory Name}

**Repository Path**: `{repo_path}`
**Total Python Files**: {total_count} ({direct_count} in this directory)
**Subdirectories**: {subdir_count}

## Overview

{layer_description from wiki_hierarchy_builder}

## Files in This Directory

{For each file:}
- [{module_name}]({wiki_path}) {ETL_badge_if_applicable}
  - {brief_description}
  - {class_count} classes, {function_count} functions

## Subdirectories

- [{subdir_1}]({wiki_path}) - {description} ({file_count} files)
- [{subdir_2}]({wiki_path}) - {description} ({file_count} files)

## Architecture Notes

{If applicable, architectural context for this directory}

## Navigation

- [‚¨ÜÔ∏è Parent Directory]({parent_wiki_path})
- [üìÅ View in Repository]({repo_folder_url})

---
*Auto-generated directory index*
*Last updated: {timestamp}*
*Generated by: wiki-auto-documenter skill*
```

## Markdown Formatting Guidelines

### Headers
- H1 (`#`): Page title only
- H2 (`##`): Major sections
- H3 (`###`): Subsections
- H4 (`####`): Component details

### Code Blocks
Always specify language for syntax highlighting:
```python
def example():
    return "formatted code"
```

### Links
- **Relative wiki links**: `[Link](../folder/page)`
- **Repository links**: `[View Source](https://dev.azure.com/...)`
- **Anchor links**: `[Jump](#section-name)`

### Tables
Use for structured data:
```markdown
| Column 1 | Column 2 | Column 3 |
|----------|----------|----------|
| Data 1   | Data 2   | Data 3   |
```

### Badges
Use inline code for badges:
- ETL pattern: `` `[ETL]` ``
- Layer indicator: `` `[Gold]` ``, `` `[Silver]` ``
- Status: `` `[Active]` ``, `` `[Deprecated]` ``

### Lists
- Use `-` for unordered lists
- Use `1.` for ordered lists
- Indent with 2 spaces for nested lists

### Emphasis
- **Bold** for important terms
- *Italic* for emphasis
- `code` for identifiers and paths

## Auto-Generation Metadata

Include at the end of every page:
```markdown
---
*Auto-generated documentation*
*Last updated: {ISO_timestamp}*
*Generated by: wiki-auto-documenter skill*
```

This helps users understand the documentation source and freshness.

## Cross-Reference Patterns

### Medallion Architecture Links
Always link related layers:
- Gold ‚Üí Silver (upstream source)
- Silver ‚Üí Bronze (upstream source) and Gold (downstream consumer)
- Bronze ‚Üí Silver (downstream consumer)

### Dependency Links
Link to all imported internal modules:
```markdown
- [`TableUtilities`](../utilities/session_optimiser#tableutilities)
- [`SparkOptimiser`](../utilities/session_optimiser#sparkoptimiser)
```

### Test Coverage Links
In test files, link to modules under test:
```markdown
**Tests**: [g_cms_address](../gold/g_cms_address)
```

---

**Template Version**: 1.0
**Last Updated**: 2025-11-12
